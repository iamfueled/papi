<?php 
class Infortis_UltraMegamenu_Block_Navigation extends Mage_Catalog_Block_Navigation{protected $x0b = FALSE; protected $x0c = FALSE; protected $x0d = ''; protected $x0e = NULL;protected function _renderCategoryMenuItemHtml($x0f, $x10 = 0, $x11 = false, $x12 = false,$x13 = false, $x14 = '', $x15 = '', $x16 = false){if (!$x0f->getIsActive()) {return '';}$x17 = array(); if (Mage::helper('catalog/category_flat')->isEnabled()) {$x18 = (array)$x0f->getChildrenNodes();$x19 = count($x18);} else {$x18 = $x0f->getChildren();$x19 = $x18->count();}$x1a = ($x18 && $x19); $x1b = array();foreach ($x18 as $x1c) {if ($x1c->getIsActive()) {$x1b[] = $x1c;}}$x1d = count($x1b);$x1e = ($x1d > 0); $x1f = Mage::helper('ultramegamenu');$x20 = Mage::getModel('catalog/category')->load($x0f->getId()); $x21 = FALSE;if ($this->_isWide){$x21 = $x1e; if ($x1f->getCfg('widemenu/show_if_no_children')) {$x21 = true; }} $x22 = array();$x23 = array();$x24 = false;$x25 = 0;if ($x10 == 0 && $this->_isAccordion == FALSE && $x21){ $x26 = $this->_getCatBlock($x20, 'umm_cat_block_right'); $x27 = 6; if ($x28 = $x20->getData('umm_cat_block_proportions')) {$x28 = explode("\x2f", $x28);$x29 = $x28[0];$x2a = $x28[1]; } else {$x29 = 4;$x2a = 2; } $x25 = $x29 + $x2a; if (empty($x26)){$x29 += $x2a;$x2a = 0;$x2b = 'grid12-12';} elseif (!$x1e){$x2a += $x29;$x29 = 0;$x2c = 'grid12-12'; } else { $x2d = 12 / $x25;$x2b = 'grid12-' . ($x29 * $x2d);$x2c = 'grid12-' . ($x2a * $x2d); }$x25 = $x29 + $x2a; $x2e = '';if ($x2e = $this->_getCatBlock($x20, 'umm_cat_block_top')) {$x22[] = '<div class="nav-block nav-block-top grid-full std">';$x22[] = $x2e;$x22[] = '</div>'; }if ($x1e) {$x2f = 'itemgrid itemgrid-'. $x29 .'col';$x22[] = '<div class="nav-block nav-block-center '. $x2b .' '. $x2f .'">'; $x23[] = '</div>'; }if ($x26) {$x23[] = '<div class="nav-block nav-block-right std '. $x2c .'">';$x23[] = $x26;$x23[] = '</div>'; }if ($x2e = $this->_getCatBlock($x20, 'umm_cat_block_bottom')) {$x23[] = '<div class="nav-block nav-block-bottom grid-full std">';$x23[] = $x2e;$x23[] = '</div>'; }if (!empty($x22) || !empty($x23))$x24 = true;} $x30 = array();$x30[] = 'level' . $x10;$x30[] = 'nav-' . $this->_getItemPosition($x10);if ($this->isCategoryActive($x0f)) {$x30[] = 'active';}$x31 = '';if ($x13 && $x14) {$x30[] = $x14;$x31 = ' class="'.$x14.'"';}if ($x12) {$x30[] = 'first';}if ($x11) {$x30[] = 'last';} if ($x1e || $x24) {$x30[] = 'parent';} if ($x10 == 1 && $this->_isAccordion == FALSE && $this->_isWide) { $x30[] = 'item';} $x32 = array();if (count($x30) > 0) {$x32['class'] = implode(' ', $x30);}if ($x1e && !$x16) { $x32['onmouseover'] = 'toggleMenu(this,1)'; $x32['onmouseout'] = 'toggleMenu(this,0)';} $x33 = '<li';foreach ($x32 as $x34 => $x35) {$x33 .= ' ' . $x34 . '="' . str_replace('"', '\"', $x35) . '"';}$x33 .= '>';$x17[] = $x33; if ($x10 == 1 && $this->_isAccordion == FALSE && $this->_isWide){ if ($x2e = $this->_getCatBlock($x20, 'umm_cat_block_top')) {$x17[] = '<div class="nav-block nav-block-level1-top std">';$x17[] = $x2e;$x17[] = '</div>'; }} $x36 = $this->_getCategoryLabelHtml($x20, $x10); $x17[] = '<a href="' . $this->getCategoryUrl($x0f) . '"' . $x31 . '>';$x17[] = '<span>' . $this->escapeHtml($x0f->getName()) . $x36 . '</span>'; $x17[] = '</a>'; $x37 = '';$x38 = 0;foreach ($x1b as $x1c) {$x37 .= $this->_renderCategoryMenuItemHtml($x1c,($x10 + 1),($x38 == $x1d - 1),($x38 == 0),false,$x14,$x15,$x16);$x38++;} if ($x10 == 0 && $this->_isAccordion == FALSE && $this->_isWide){ $x15 = 'level0-wrapper dropdown-' . $x25 . 'col';} if (!empty($x37) || $x24) {if ($this->_isAccordion == TRUE)$x17[] = '<span class="opener">&nbsp;</span>';if ($x15) {$x17[] = '<div class="' . $x15 . '">';} $x17[] = implode("", $x22); if (!empty($x37)){$x17[] = '<ul class="level' . $x10 . '">';$x17[] = $x37;$x17[] = '</ul>'; }$x17[] = implode("", $x23); if ($x15) {$x17[] = '</div>';}} if ($x10 == 1 && $this->_isAccordion == FALSE && $this->_isWide){ if ($x2e = $this->_getCatBlock($x20, 'umm_cat_block_bottom')) {$x17[] = '<div class="nav-block nav-block-level1-bottom std">';$x17[] = $x2e;$x17[] = '</div>'; }} $x17[] = '</li>';$x17 = implode("\n", $x17);return $x17;}public function renderCategoriesMenuHtml($x39 = FALSE, $x10 = 0, $x14 = '', $x15 = ''){ $this->_isAccordion = $x39;$this->_isWide = Mage::helper('ultramegamenu')->getCfg('mainmenu/wide_menu'); $x3a = array();foreach ($this->getStoreCategories() as $x1c) {if ($x1c->getIsActive()) {$x3a[] = $x1c;}}$x3b = count($x3a);$x3c = ($x3b > 0);if (!$x3c) {return '';}$x17 = '';$x38 = 0;foreach ($x3a as $x0f) {$x17 .= $this->_renderCategoryMenuItemHtml($x0f,$x10,($x38 == $x3b - 1),($x38 == 0),true,$x14,$x15,true);$x38++;}return $x17;}protected function _getCatBlock($x20, $x3d){if (!$this->_tplProcessor){ $this->_tplProcessor = Mage::helper('cms')->getBlockTemplateProcessor();}return $this->_tplProcessor->filter( trim($x20->getData($x3d)) ); }protected function _getCategoryLabelHtml($x20, $x10){$x3e = $x20->getData('umm_cat_label');if ($x3e){ $x3f = trim(Mage::helper('ultramegamenu')->getCfg('category_labels/' . $x3e)); if ($x3f) {if ($x10 == 0){ return ' <span class="cat-label cat-label-'. $x3e .' pin-bottom">' . $x3f . '</span>';}else{ return ' <span class="cat-label cat-label-'. $x3e .'">' . $x3f . '</span>';} }}return ''; }}